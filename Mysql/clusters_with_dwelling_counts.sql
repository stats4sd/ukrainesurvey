select `ukraine`.`clusters`.`id` AS `id`,`ukraine`.`clusters`.`region_id` AS `region_id`,`ukraine`.`regions`.`name_en` AS `region_name_en`,`ukraine`.`regions`.`name_uk` AS `region_name_uk`,`ukraine`.`clusters`.`sample_id` AS `sample_id`, `ukraine`.`clusters`.`sample_taken` AS `sample_taken`, `ukraine`.`clusters`.`type` AS `type`,`ukraine`.`clusters`.`locality_type` AS `locality_type`,`ukraine`.`clusters`.`num_voters` AS `num_voters`,`ukraine`.`clusters`.`smd_id` AS `smd_id`,`buildings_per_cluster`.`tot` AS `tot_buildings`,sum(`dwellings_per_building`.`tot`) AS `tot_dwellings`,if((sum(`dwellings_per_building`.`tot_collected`) = 16),1,0) AS `cluster_completed` from (((`ukraine`.`clusters` left join `ukraine`.`regions` on((`ukraine`.`regions`.`id` = `ukraine`.`clusters`.`region_id`))) join (select `ukraine`.`buildings`.`cluster_id` AS `cluster_id`,count(`ukraine`.`buildings`.`id`) AS `tot` from `ukraine`.`buildings` group by `ukraine`.`buildings`.`cluster_id`) `buildings_per_cluster` on((`buildings_per_cluster`.`cluster_id` = `ukraine`.`clusters`.`id`))) join (select `ukraine`.`dwellings`.`building_id` AS `building_id`,sum(`ukraine`.`dwellings`.`data_collected`) AS `tot_collected`,count(`ukraine`.`dwellings`.`id`) AS `tot`,`ukraine`.`buildings`.`cluster_id` AS `cluster_id` from (`ukraine`.`dwellings` left join `ukraine`.`buildings` on((`ukraine`.`buildings`.`id` = `ukraine`.`dwellings`.`building_id`))) group by `ukraine`.`dwellings`.`building_id`) `dwellings_per_building` on((`dwellings_per_building`.`cluster_id` = `ukraine`.`clusters`.`id`))) group by `ukraine`.`clusters`.`id`